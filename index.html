<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calculadora de Honor√°rios</title>
    <meta name="theme-color" content="#0a304b">
    <meta name="description" content="Cron√¥metro de honor√°rios com c√°lculo em tempo real">
	
	 <!-- GOOGLE ADSENSE - VERIFICA√á√ÉO + AN√öNCIOS -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3901126634352230"
        crossorigin="anonymous"></script>

	

    <!-- PWA -->
    <link rel="manifest" href="data:application/manifest+json,{
        %22name%22:%22Calculadora de Honor√°rios%22,
        %22short_name%22:%22Honor√°rios%22,
        %22start_url%22:%22.%22,
        %22display%22:%22standalone%22,
        %22background_color%22:%22#0a304b%22,
        %22theme_color%22:%22#0a304b%22,
        %22icons%22:[{%22src%22:%22data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%230a304b'/%3E%3Ctext x='50' y='60' font-size='60' text-anchor='middle' fill='%23ffffff'%3Eüí∞%3C/text%3E%3C/svg%3E%22,%22sizes%22:%22192x192%22,%22type%22:%22image/svg+xml%22}]
    }">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%230a304b'/%3E%3Ctext x='50' y='60' font-size='60' text-anchor='middle' fill='%23ffffff'%3Eüí∞%3C/text%3E%3C/svg%3E">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700;800&display=swap');
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: #0a304b;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        .card {
            background: rgba(255,255,255,0.06);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            width: 100%;
            max-width: 420px;
            padding: 40px 28px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        }
        h2 { font-size: 26px; font-weight: 800; margin-bottom: 8px; }
        p { font-size: 15px; color: #bbbbbb; line-height: 1.5; margin-bottom: 30px; }
        .tempo-label { font-size: 16px; color: #cccccc; margin-bottom: 6px; font-weight: 600; }
        .tempo { font-size: 58px; font-weight: 800; letter-spacing: -2px; color: #ffffff; margin: 10px 0 25px; font-variant-numeric: tabular-nums; }
        .valor-label { font-size: 16px; color: #cccccc; margin: 22px 0 6px; font-weight: 600; }
        .valor { font-size: 38px; font-weight: 800; color: #1DB954; }
        .liquido { font-size: 32px; font-weight: 800; color: #00cc66; margin: 12px 0 30px; }
        label { display: block; text-align: left; font-size: 15px; font-weight: 600; color: #cccccc; margin: 22px 0 8px; }
        input {
            width: 100%; padding: 18px; font-size: 19px; text-align: center;
            background: rgba(255,255,255,0.08); border: 2px solid #2a5d84;
            border-radius: 14px; color: white;
        }
        input:focus { outline: none; border-color: #0c6ef1; }
        .botoes { display: flex; gap: 16px; margin-top: 35px; }
        button {
            flex: 1; padding: 20px; font-size: 19px; font-weight: 700;
            border: none; border-radius: 16px; cursor: pointer; transition: all 0.25s;
        }
        button:active { transform: translateY(3px); }
        #btnIniciar { background: #0c6ef1; color: white; }
        #btnIniciar.parado { background: #ff751f !important; }
        #btnResetar, #btnLimpar { background: #ff3131; color: white; }
        #btnCopiar { background: #00cc66; color: white; margin-top: 16px; }
        .historico {
            margin-top: 40px; text-align: left; font-size: 14px; max-height: 200px;
            overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 12px; padding: 12px;
        }
        .sessao { padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1); opacity: 0.9; }
        .sessao:last-child { border-bottom: none; }
        .rodape { margin-top: 50px; font-size: 16px; color: #ffffff; }
        .rodape a { color: #ff9900; text-decoration: none; font-weight: 800; }
    </style>
</head>
<body>

<div class="card">
    <h2>Calculadora de Honor√°rios</h2>
    <p>Acompanhe suas horas com precis√£o e gere relat√≥rios instant√¢neos.</p>

    <div class="tempo-label">Tempo Decorrido</div>
    <div class="tempo" id="tempo">00:00:00<span class="milissegundos">,00</span></div>

    <div class="valor-label">Valor Bruto a Receber</div>
    <div class="valor" id="bruto">R$ 0,00</div>

    <div class="valor-label">Valor L√≠quido a Receber</div>
    <div class="liquido" id="liquido">R$ 0,00</div>

    <label>Valor por Hora (R$)</label>
    <input type="number" id="valorHora" value="150" step="0.01" min="0">

    <label>Impostos e taxas (%) ‚Äì opcional</label>
    <input type="number" id="impostos" value="20" step="0.01" min="0" max="100">

    <div class="botoes">
        <button id="btnIniciar">Iniciar</button>
        <button id="btnResetar">Resetar</button>
    </div>

    <button id="btnCopiar">üìã Copiar Relat√≥rio</button>

    <div class="historico" id="historico"></div>

    <div class="rodape">
        Desenvolvido por <a href="https://wa.me/5511988484500" target="_blank">Trafer Digital</a>
    </div>
</div>

<script>
// Vari√°veis de controle
let inicio = 0;        // timestamp do √∫ltimo "iniciar"
let offset = 0;        // tempo acumulado j√° pausado
let correndo = false;
let ultimaHoraNotificada = -1;

const tempoEl = document.getElementById('tempo');
const milissegundosEl = document.querySelector('.milissegundos');
const brutoEl = document.getElementById('bruto');
const liquidoEl = document.getElementById('liquido');
const btnIniciar = document.getElementById('btnIniciar');
const btnResetar = document.getElementById('btnResetar');
const btnCopiar = document.getElementById('btnCopiar');
const inputValorHora = document.getElementById('valorHora');
const inputImpostos = document.getElementById('impostos');
const historicoEl = document.getElementById('historico');

// ===========================================
// Fun√ß√µes principais
// ===========================================
function atualizarDisplay() {
    const decorrido = correndo ? offset + (Date.now() - inicio) : offset;

    const h = Math.floor(decorrido / 3600000);
    const m = Math.floor((decorrido % 3600000) / 60000);
    const s = Math.floor((decorrido % 60000) / 1000);
    const ms = Math.floor((decorrido % 1000) / 10);

    tempoEl.innerHTML = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}<span class="milissegundos">,${String(ms).padStart(2,'0')}</span>`;

    // Notifica√ß√£o de hora cheia + som
    if (h > ultimaHoraNotificada && h > 0) {
        ultimaHoraNotificada = h;
        const audio = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAIlB0ZWFrcwAAAAATY2F0YQAAAAAAAAB4");
        audio.play().catch(() => {});
    }

    const valorHora = parseFloat(inputValorHora.value) || 0;
    const impostosPerc = parseFloat(inputImpostos.value) || 0;
    const bruto = (decorrido / 3600000) * valorHora;
    const liquido = impostosPerc > 0 ? bruto * (1 - impostosPerc / 100) : bruto;

    brutoEl.textContent = bruto.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    liquidoEl.textContent = liquido.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
}

function loop() {
    if (correndo) {
        atualizarDisplay();
        requestAnimationFrame(loop);
    }
}

// ===========================================
// Persist√™ncia (localStorage)
// ===========================================
function salvarEstado() {
    const estado = {
        offset: correndo ? offset + (Date.now() - inicio) : offset,
        correndo,
        valorHora: inputValorHora.value,
        impostos: inputImpostos.value
    };
    localStorage.setItem('calcHonorarios_v2', JSON.stringify(estado));
}

function carregarEstado() {
    const salvo = localStorage.getItem('calcHonorarios_v2');
    if (!salvo) return;

    const data = JSON.parse(salvo);
    offset = data.offset || 0;
    correndo = data.correndo || false;
    inputValorHora.value = data.valorHora || 150;
    inputImpostos.value = data.impostos || 20;

    if (correndo) {
        inicio = Date.now() - (data.offset || 0) + offset; // corre√ß√£o principal aqui
        btnIniciar.textContent = "Pausar";
        btnIniciar.classList.add('parado');
        requestAnimationFrame(loop);
    }
    atualizarDisplay();
    carregarHistorico();
}

function carregarHistorico() {
    const hist = localStorage.getItem('calcHistorico_v2') || '[]';
    const arr = JSON.parse(hist).slice(-10).reverse();
    historicoEl.innerHTML = arr.map(s => `<div class="sessao">${s}</div>`).join('');
}

function adicionarHistorico() {
    if (offset + (correndo ? Date.now() - inicio : 0) < 5000) return; // menos de 5s n√£o salva

    const tempoTexto = tempoEl.textContent + milissegundosEl.textContent;
    const data = new Date().toLocaleString('pt-BR', { day:'2-digit', month:'2-digit', year:'numeric', hour:'2-digit', minute:'2-digit' });
    const linha = `${data} ‚Ä¢ ${tempoTexto} ‚Ä¢ ${brutoEl.textContent} ‚Ä¢ ${liquidoEl.textContent}`;

    let hist = JSON.parse(localStorage.getItem('calcHistorico_v2') || '[]');
    hist.push(linha);
    if (hist.length > 50) hist.shift();
    localStorage.setItem('calcHistorico_v2', JSON.stringify(hist));
    carregarHistorico();
}

// ===========================================
// Bot√µes
// ===========================================
btnIniciar.onclick = () => {
    if (!correndo) {
        inicio = Date.now();
        correndo = true;
        btnIniciar.textContent = "Pausar";
        btnIniciar.classList.add('parado');
        requestAnimationFrame(loop);
    } else {
        offset += Date.now() - inicio;
        correndo = false;
        btnIniciar.textContent = "Iniciar";
        btnIniciar.classList.remove('parado');
    }
    salvarEstado();
};

btnResetar.onclick = () => {
    if (correndo) {
        offset += Date.now() - inicio;
        correndo = false;
    }
    adicionarHistorico();

    offset = 0;
    ultimaHoraNotificada = -1;
    btnIniciar.textContent = "Iniciar";
    btnIniciar.classList.remove('parado');
    atualizarDisplay();
    salvarEstado();
};

btnCopiar.onclick = () => {
    const texto = `üìä RELAT√ìRIO DE HONOR√ÅRIOS

‚è± Tempo trabalhado: ${tempoEl.textContent}${milissegundosEl.textContent}
üí∞ Valor bruto: ${brutoEl.textContent}
üí∏ Valor l√≠quido: ${liquidoEl.textContent}
üíº Valor/hora: R$ ${parseFloat(inputValorHora.value || 0).toFixed(2)}
üìâ Impostos: ${inputImpostos.value || 0}%

Gerado em ${new Date().toLocaleString('pt-BR')}`;

    navigator.clipboard.writeText(texto).then(() => {
        btnCopiar.textContent = "‚úÖ Copiado!";
        setTimeout(() => btnCopiar.textContent = "üìã Copiar Relat√≥rio", 2000);
    });
};

// Inputs
[inputValorHora, inputImpostos].forEach(i => i.addEventListener('input', () => {
    atualizarDisplay();
    salvarEstado();
})); 

// Salvar periodicamente
setInterval(() => {
    if (correndo || offset > 0) salvarEstado();
}, 3000);

// Inicializa√ß√£o
carregarEstado();

// Service Worker (PWA offline)
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('data:application/javascript,self.addEventListener("install",e=>self.skipWaiting());self.addEventListener("fetch",e=>e.respondWith(caches.match(e.request)||fetch(e.request)));');
}
</script>
</body>
</html>